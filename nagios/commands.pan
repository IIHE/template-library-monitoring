# Template with command definitions to be used by Nagios.
# Responsible: Luis Fernando Muñoz Mejías.

# Some of these checks can be found at the "nagios-uam-plugins"
# package, available at http://gridp03/swrep/{x86_64,i386}_sl4/
structure template monitoring/nagios/commands;

"notify-by-email" = "/bin/echo '$SERVICEOUTPUT$' | /bin/mail -s '$SERVICESTATE$ alert for $HOSTALIAS$($HOSTNAME$)/$SERVICEDESC$' $CONTACTEMAIL$";
"notify-by-epager" = "/bin/echo '$SERVICEOUTPUT$' | /bin/mail -s '$HOSTALIAS$/$SERVICEDESC$ is $SERVICESTATE$' $CONTACTPAGER$";
"host-notify-by-email" = "/bin/echo -e '***** Nagios *****\\n\\nHost '$HOSTALIAS$' is $HOSTSTATE$!\\n\\nDate/Time: $SHORTDATETIME$\\n' | /bin/mail -s 'Host $HOSTALIAS$($HOSTNAME$) is $HOSTSTATE$!' $CONTACTEMAIL$";
"host-notify-by-epager" = "/bin/echo '$HOSTALIAS$ is $HOSTSTATE$!' | /bin/mail -s 'Host $HOSTNAME$ is $HOSTSTATE$!' $CONTACTPAGER$";
"notify-by-qpage" = "/usr/bin/printf 'Service: %s\\nHost: %s\\nAddress: %s\\nState: %s\\nInfo: %s\\nDate: %s' '$SERVICEDESC$' '$HOSTNAME$' '$HOSTADDRESS$' '$SERVICESTATE$' '$OUTPUT$' '$DATETIME$' | /usr/local/bin/qpage -l 0 -p $CONTACTPAGER$";
"host-notify-by-qpage" = "/usr/bin/printf 'Host: %s is %s\\nInfo: %s\\nDate: %s' '$HOSTALIAS$' '$HOSTSTATES$' '$OUTPUT$' '$DATETIME$' | /usr/local/bin/qpage -l 0 -p $CONTACTPAGER$";
"notify-by-smsclient" = "/usr/bin/sms_client -q $CONTACTPAGER$ '$NOTIFICATIONTYPE$: $HOSTADDRESS$ $HOSTALIAS$: $SERVICEDESC$ is $SERVICESTATE$'";
"host-notify-by-smsclient" = "/usr/bin/sms_client -q $CONTACTPAGER$ 'Host $HOSTALIAS$ is $HOSTSTATE$; $OUTPUT$; $SHORTDATETIME$'";
"check_tcp" = "$USER1$/check_tcp -H $HOSTADDRESS$ -p $ARG1$";
"check_udp" = "$USER1$/check_udp -H $HOSTADDRESS$ -p $ARG1$";
"check_ftp" = "$USER1$/check_ftp -H $HOSTADDRESS$";
"check_pop" = "$USER1$/check_pop -H $HOSTADDRESS$";
"check_smtp" = "$USER1$/check_smtp -H $HOSTADDRESS$";
"check_nntp" = "$USER1$/check_nntp -H $HOSTADDRESS$";
"check_telnet" = "$USER1$/check_tcp -H $HOSTADDRESS$ -p 23";
"check_users" = "$USER1$/check_users -w $ARG1$ -c $ARG2$";
"check_ntp" = "$USER1$/check_ntp -H $HOSTADDRESS$";
"check_ntp_ntpq" = "$USER1$/check_ntp -H $HOSTADDRESS$ -j 10 -k 15";
"check_flexlm" = "$USER1$/check_flexlm -F $ARG1$";
"check_hpjd" = "$USER1$/check_hpjd -H $HOSTADDRESS$ -C public";
"check_mrtg" = "$USER1$/check_mrtg $ARG1$ 10 AVG $ARG2$ $ARG3$ $ARG4$ $ARG5$ $ARG6$";
"traffic_average" = "$USER1$/check_mrtgtraf $ARG1$ 10 AVG $ARG2$ $ARG3$ $ARG4$ $ARG5$";
"check_load" = "$USER1$/check_load $ARG1$ $ARG2$ $ARG3$ $ARG4$ $ARG5$ $ARG6$";
"check_disk" = "$USER1$/check_disk -w 85% -c 95% -p $ARG1$";
"check_dns" = "$USER1$/check_dns -H $ARG1$ -s $HOSTADDRESS$ -w $ARG2$ -c $ARG3$";
"check_http" = "$USER1$/check_http -H $HOSTADDRESS$ -I $HOSTADDRESS$";
"check_http2" = "$USER1$/check_http -H $HOSTADDRESS$ -I $HOSTADDRESS$ -w $ARG1$ -c $ARG2$ -u $ARG3$";
"check_pgsql" = "$USER1$/check_pgsql -H $HOSTADDRESS$ ";
"check_ping" = "$USER1$/check_ping -H $HOSTADDRESS$ -w 10:20% -c 60:100%";
"check_procs" = "$USER1$/check_procs -w $ARG1$ -c $ARG2$";
"check_procs_swap" = "$USER1$/check_procs -w $ARG1$ -c $ARG2$  -s W";
"check_procs_zombie" = "$USER1$/check_procs -w $ARG1$ -c $ARG2$ -s Z";
"check_procs_httpd" = "$USER1$/check_procs -w 5:$ARG1$ -c 1:$ARG2$ -C httpd";
"check_procs_vsz" = "$USER1$/check_procs -w 8096 -c 16182 -C httpd --metric VSZ";
"ssh_disk" = "$USER1$/check_by_ssh -H $HOSTADDRESS$ -C '$USER1$/check_disk -w 85% -c 95% -p $ARG1$'";
"snmp_load" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o .1.3.6.1.4.1.2021.10.1.5.1,.1.3.6.1.4.1.2021.10.1.5.2,.1.3.6.1.4.1.2021.10.1.5.3 -w :$ARG2$,:$ARG3$,:$ARG4$ -w :$ARG5$,:$ARG6$,:$ARG7$ -l load";
"snmp_cpustats" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o .1.3.6.1.4.1.2021.11.9.0,.1.3.6.1.4.1.2021.11.10.0,.1.3.6.1.4.1.2021.11.11.0 -l 'CPU usage (user system idle)' -u '%'";
"snmp_procname" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o 1.3.6.1.4.1.2021.2.1.5.$ARG2$ -w $ARG3$:$ARG4$ -c $ARG5$:$ARG6$";
"snmp_disk" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o 1.3.6.1.4.1.2021.9.1.7.$ARG1$,1.3.6.1.4.1.2021.9.1.9.$ARG1$ -w $ARG2$:,:$ARG3$ -c $ARG4$:,:$ARG5$ -u 'kB free (','% used)' -l 'disk space'";
"snmp_mem" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o .1.3.6.1.4.1.2021.4.6.0,.1.3.6.1.4.1.2021.4.5.0 -w $ARG2$: -c $ARG3$:";
"snmp_swap" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o .1.3.6.1.4.1.2021.4.4.0,.1.3.6.1.4.1.2021.4.3.0 -w $ARG2$: -c $ARG3$:";
"snmp_procs" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o host.hrSystem.hrSystemProcesses -w :$ARG2$ -c :$ARG3$ -l processes";
"snmp_users" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o host.hrSystem.hrSystemNumUsers -w :$ARG2$ -c :$ARG3$ -l users";
"snmp_mem2" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageUsed.101,host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageSize.101 -w $ARG2$ -c $ARG3$";
"snmp_swap2" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageUsed.102,host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageSize.102 -w $ARG2$ -c $ARG3$";
"snmp_mem3" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageUsed.101,host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageSize.101 -w $ARG2$ -c $ARG3$";
"snmp_swap3" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageUsed.102,host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageSize.102 -w $ARG2$ -c $ARG3$";
"snmp_disk2" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o host.hrStorage.hrStorageTable.hrStorageEntry.hrStorageUsed.$ARG2$ -w $ARG3$ -c $ARG4$ ";
"snmp_tcpopen" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o tcp.tcpCurrEstab.0 -w $ARG2$ -c $ARG3$";
"snmp_tcpstats" = "$USER1$/check_snmp -H $HOSTADDRESS$ -C $ARG1$ -o tcp.tcpActiveOpens.0,tcp.tcpPassiveOpens.0,tcp.tcpInSegs.0,tcp.tcpOutSegs.0,tcp.tcpRetransSegs.0 -l 'TCP stats'";
"check_ifstatus" = "$USER1$/check_ifstatus -H $HOSTADDRESS$ -C public ";
"check_ifoperstatus_ifindex" = "$USER1$/check_ifoperstatus -H $HOSTADDRESS$ -C public -k $ARG1$";
"check_ifoperstatus_ifdescr" = "$USER1$/check_ifoperstatus -H $HOSTADDRESS$ -C public -d $ARG1$";
"check_snmp_bgpstate" = "$USER1$/check_bgpstate -H $HOSTADDRESS$ -C public";
"check-host-alive" = "$USER1$/check_ping -H $HOSTADDRESS$ -w 5000,100% -c 5000,100% -p 1";
"check-printer-alive" = "$USER1$/check_ping -H $HOSTADDRESS$ -w 5000,100% -c 5000,100% -p 1";
"check-switch-alive" = "$USER1$/check_ping $HOSTADDRESS$ -w 5000,100% -c 5000,100% -p 1";
"check-router-alive" = "$USER1$/check_ping -H $HOSTADDRESS$ -w 5000,100% -c 5000,100% -p 1";
"check-fast-alive" = "$USER1$/check_fping -H $HOSTADDRESS$";
"check-imap" = "$USER1$/check_imap -H $HOSTADDRESS$";
"check-rpc" = "$USER1$/check_rpc -H $HOSTADDRESS$ -C $ARG1$";
"check-nfs" = "$USER1$/check_rpc -H $HOSTADDRESS$ -C nfs -c2,3";
"check_quake" = "$USER1$/check_game qs $HOSTADDRESS$";
"check_unreal" = "$USER1$/check_game uns $HOSTADDRESS$ -p $ARG1$ -pf 8";
"check_nmap" = "$USER1$/check_nmap -H $HOSTADDRESS$ -t 30 -p $ARG1$";
"check_nmap_optional" = "$USER1$/check_nmap -H $HOSTADDRESS$ -t 60 -p $ARG1$ -o $ARG2$";
"check_nmap_range" = "$USER1$/check_nmap -H $HOSTADDRESS$ -t 60 -p $ARG1$ -r $ARG2$";
"check_nmap_opt_range" = "$USER1$/check_nmap -H $HOSTADDRESS$ -t 60 -p $ARG1$ -o $ARG2$ -r$ARG3$";
"check_radius" = "$USER1$/check_radius $ARG1$ $ARG2$ $HOSTADDRESS$ 1812 $ARG3$";
"check_squid" = "$USER1$/check_http -H $HOSTADDRESS$ -p $ARG1$  -u $ARG2$  -e 'HTTP/1.0 200 OK'";
"check_real_url" = "$USER1$/check_real $HOSTADDRESS$ -p $ARG1$ -wt $ARG2$ -ct $ARG3$ -to 5 -u $ARG4$";
"check_real" = "$USER1$/check_real $HOSTADDRESS$ -p $ARG1$ -wt $ARG2$ -ct $ARG3$ -to 5";
"check_netware_logins" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v 'LOGINS' -w $ARG1$ -c $ARG2$";
"check_nwstat_conns" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v CONNS -w $ARG1$ -c $ARG2$";
"check_netware_1load" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v 'LOAD1' -w 70 -c 90";
"check_netware_5load" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v 'LOAD5' -w 70 -c 90";
"check_netware_15load" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v 'LOAD15' -w 70 -c 90";
"check_nwstat_vol_p" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v VPF$ARG1$ -w $ARG2$ -c $ARG3$";
"check_nwstat_vol_k" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v VKF$ARG1$ -w $ARG2$ -c $ARG3$";
"check_nwstat_ltch" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v LTCH -w $ARG1$ -c $ARG2$";
"check_nwstat_puprb" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v PUPRB -w $ARG1$ -c $ARG2$";
"check_nwstat_dsdb" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v DSDB";
"check_iferrors" = "/usr/bin/perl -wT $USER1$/check_iferrors -w $ARG1$ -c $ARG2$ -i $ARG3$ -p '$SERVICEOUTPUT$'";
"check_netware_abend" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v 'ABENDS' -w 10 -c 30";
"check_nwstat_csprocs" = "$USER1$/check_nwstat -H $HOSTADDRESS$ -v CSPROCS -w $ARG1$ -c $ARG2$";
"check_ssh" = "$USER1$/check_ssh -H $HOSTADDRESS$";
"check_local_load" = "$USER1$/check_load -w $ARG1$ -c $ARG2$";
"check_local_users" = "$USER1$/check_users -w $ARG1$ -c $ARG2$";
"check_local_disk" = "$USER1$/check_disk -w $ARG1$ -c $ARG2$ -p $ARG3$";
"check_local_procs" = "$USER1$/check_procs -w $ARG1$ -c $ARG2$ -s $ARG3$";
"check_nrpe" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c $ARG1$ -a $ARG2$ $ARG3$ $ARG4$ $ARG5$ $ARG6$ $ARG7$ $ARG8$ $ARG9$ $ARG10$ $ARG11$";
"check_nrpe_load" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_load -a $ARG1$ $ARG2$";
"check_nrpe_users" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_users -a $ARG1$ $ARG2$";
"check_nrpe_all_procs" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_all_procs -a $ARG1$ $ARG2$";
"check_nrpe_certdates" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_certdates -a $ARG1$ $ARG2$";
"check_nrpe_procs_zombie" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_procs_zombie -a $ARG1$ $ARG2$ $ARG3$ $ARG4$ $ARG5$ $ARG6$ $ARG7$ $ARG8$ $ARG9$";
"check_nrpe_pbs" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_pbs -a $ARG1$ $ARG2$ $ARG3$ $ARG4$ $ARG5$ $ARG6$ $ARG7$ $ARG8$ $ARG9$";
"check_nrpe_procs_swap" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_procs -a $ARG1$ $ARG2$ W";
"check_nrpe_swap" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_swap -a $ARG1$ $ARG2$ ";
"check_nrpe_disk" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_disk -a $ARG1$ $ARG2$ $ARG3$";
"check_nrpe_iferrors" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_iferrors -a $ARG1$ $ARG2$ $ARG3$ '$SERVICEOUTPUT$'";
#"check_nrpe_gridftp_door" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -t 30 -c check_gridftp_door";
"process-service-perfdata" = "/usr/bin/perl /usr/libexec/process_perfdata.pl";
"process-host-perfdata" = "/usr/bin/printf '%b' '$LASTHOSTCHECK$\t$HOSTNAME$\t$HOSTSTATE$\t$HOSTATTEMPT$\t$HOSTSTATETYPE$\t$HOSTEXECUTIONTIME$\t$HOSTOUTPUT$\t$HOSTPERFDATA$\\n' >> /var/log/nagios/host-perfdata.out";
"check_swap" = "$USER1$/check_swap -w $ARG1$ -c $ARG2$";
"check_all_procs" = "$USER1$/check_procs -w $ARG1$ -c $ARG2$";
"check_ups" = "/usr/bin/perl $USER1$/check_mge";
"service_restart" = "$USER2$/service_restart.sh $HOSTNAME$ $ARG1$ $SERVICESTATE$ $SERVICESTATETYPE$ $SERVICEATTEMPT$";
"server_shutdown" = "$USER2$/server_shutdown.sh $SERVICESTATE$ $SERVICESTATETYPE$";
"check_dcache_pools" = "/usr/bin/perl $USER1$/check_dcache_pools";
"node_handler" = "$USER2$/node_handler.sh $HOSTNAME$ $SERVICESTATE$ $SERVICESTATETYPE$";
"stop_blackhole" = "$USER2$/stop_blackhole.sh $HOSTNAME$ $SERVICESTATE$";
"check_gridftpdoor" = "$USER1$/check_nrpe -H stormon -t 30 -c check_gridftpdoor -a $HOSTADDRESS$";
"check_sensonet" = "$USER1$/check_sensonet";
"check_billing" = "$USER1$/check_nrpe -H $HOSTNAME$ -c check_billing";
"check_nrpe_bandwidth" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_bandwidth";
"check_nrpe_mounts" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_mount -a $ARG1$";
"check_local_bandwidth" = "$USER1$/check_bandwidth";
"remount" = "$USER2$/remount.sh $HOSTNAME$ $SERVICESTATE$ $SERVICESTATETYPE$ $SERVICEATTEMPTS$ $ARG1$";
"check_nrpe_ncd" = "$USER1$/check_nrpe -H $HOSTADDRESS$ -c check_ncd";
"check_token" = "$USER1$/check_nrpe -H $HOSTNAME$ -c check_token -a $ARG1$";

# ncg commands
"ncg_check_passive" = "$USER3$/check_passive";
"ncg_gather_sam" = "$USER3$/gather_sam -t 120 --site $ARG1$ $ARG2$";
"ncg_gather_npm" = "$USER3$/gather_npm -t 120 --site $ARG1$";
"ncg_check_native" = "$USER1$/$ARG1$ -H $HOSTADDRESS$ -t $ARG2$ $ARG3$";
"ncg-host-notify-by-email" = '/usr/bin/printf "%b" "***** Nagios 2.10 *****\n\nNotification Type: $NOTIFICATIONTYPE$\nHost: $HOSTNAME$\nState: $HOSTSTATE$\nAddress: $HOSTADDRESS$\nInfo: $HOSTOUTPUT$\n\nDate/Time: $LONGDATETIME$\n" | /bin/mail -s "[WLCG Nagios] Host $HOSTSTATE$ alert for $HOSTNAME$!" $CONTACTEMAIL$';
"ncg-notify-by-email" = '/usr/bin/printf "%b" "***** Nagios 2.10 *****\n\nNotification Type: $NOTIFICATIONTYPE$\nService: $SERVICEDESC$\nHost: $HOSTNAME$\nAddress: $HOSTADDRESS$\nState: $SERVICESTATE$\n\nDate/Time: $LONGDATETIME$\n\nAdditional Info:\n\n$SERVICEOUTPUT$" | /bin/mail -s "[WLCG Nagios] Service $SERVICESTATE$ alert for $HOSTNAME$/$SERVICEDESC$!" $CONTACTEMAIL$';

